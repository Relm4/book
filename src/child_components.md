# Child components

In this chapter, we will implement a simple alert dialog as a reusable child component.

The alert example in the Relm4 repository implements a simple app for the alert component that we will write in this chapter. It's an other variant of a counter app, yet this time a dialog will be displayed if the counter does not match 42 when closing. The main difference in the implementation is, that the dialog is implemented as component that can be reused in other applications.

![App screenshot dark](img/screenshots/reusable-alert-dark-1.png)

This is how the dialog looks like in the alert example:

![App screenshot dark](img/screenshots/reusable-alert-dark-2.png)

> If you want to see an alert component very similar to the one we will write in this chapter, have a look at the [“alert” example](https://github.com/Relm4/Relm4/blob/main/examples/relm4-components/alert.rs). Run `cargo run --example alert` from the [examples/relm4-components directory](https://github.com/Relm4/Relm4/tree/main/examples/relm4-components) if you want to see the code in action.

## The alert component

The alert component is defined similarly to the other components we've implemented in this book.

Our model stores whether the component is visible and its configuration.

```rust,ignore
{{#include ../examples/alert.rs:model}}
```

We define a `Widgets`, `Init`, `Input` and `Output` type as usual.

```rust,ignore
{{#include ../examples/alert.rs:types}}
```

The `Init` param is a settings object that is used to configure the component.
This maximizes the reusability of the component by letting it adapt to different use-cases.

```rust,ignore
{{#include ../examples/alert.rs:settings}}
```

In the `Input` type, this component uses `#[doc(hidden)]` on the `Response` variant. This is a useful pattern for component-internal messages that are not intended to be sent by external callers. This allows us to update the component when the underlying dialog reports a response, but not display the `Response` variant in the component's documentation.

```rust,ignore
{{#include ../examples/alert.rs:input}}
```

The `Output` type allows us to report the user's response back to a parent component.

```rust,ignore
{{#include ../examples/alert.rs:output}}
```

The update function handles the `Show` message from our parent component and the `Response` messages generated by user interactions. It also sends the appropriate messages to the parent through the output sender.

```rust,ignore
{{#include ../examples/alert.rs:component_update }}
```

When initializing the model, we conditionally set up some widgets based on the settings passed by the caller. We set `is_active` to `false` since the dialog is not currently displayed.

```rust,ignore
{{#include ../examples/alert.rs:init_model }}
```

Lastly, the view. Note that the component connects to the [`response`
signal](https://docs.gtk.org/gtk4/signal.Dialog.response.html) of the underlying dialog and sends an *input* to itself when a response is received.

```rust,ignore
{{#include ../examples/alert.rs:view}}
```

## Usage

With the component complete, let's use it!

```rust,ignore
{{#include ../examples/alert.rs:app_component}}
```

This is mostly stuff that we've already done in previous chapters, but there are a few additional things to know about interacting with child components.

Notably, we need to wrap the types of the child components in `Controller`s to be able to store them in the `App` model.

```rust,ignore
{{#include ../examples/alert.rs:app_model}}
```

We initialize them with the builder pattern in the `init` method.

```rust,ignore
{{#include ../examples/alert.rs:app_init}}
```

We call `transient_for(root)` on the builder to indicate to GTK that our root widget is transient for the main application window. This allows window managers to handle the dialog window differently, e.g. by drawing it on top of other windows.
See the [`set_transient_for` documentation](https://docs.gtk.org/gtk4/method.Window.set_transient_for.html) for more information.


```rust,ignore
{{#include ../examples/alert.rs:close}}
```

That's it! You can find more examples of reusable components in the relm4-components crate [here](https://relm4.org/docs/stable/relm4_components/).
You can also contribute your own reusable components to relm4-components :)

## The complete code

Let’s review all our code in one piece one more time to see how all these parts work together:

```rust,ignore
{{#include ../examples/alert.rs:all}}
```
